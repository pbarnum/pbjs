function ContentBox(e){if(ContentBox.prototype._instance)return ContentBox.prototype.created=!1,ContentBox.prototype._instance;ContentBox.prototype._instance=this,ContentBox.prototype.created=!0;var t={boxes:[],current:null,nextId:function(){var e=1;if(this.boxes.length<=0)return e;for(var t in this.boxes)this.boxes[t].id>e&&(e=this.boxes[e].id);return e+1},getBoxById:function(e){for(var t in this.boxes)if(this.boxes[t].id==e)return this.boxes[t];return null},setCurrent:function(e){this.boxes.length<=0&&(this.current=null);var t=this.getBoxById(e);t?this.current=t.id:this.current=this.boxes[this.boxes.length-1].id},addBox:function(e){ContentBox.prototype.created=!0,this.boxes.push(e),this.setCurrent(e.id),document.body.appendChild(e.element)},removeBox:function(e){var t=this.getBoxById(e);t.element.parentNode.removeChild(t.element),this.setCurrent(),this.boxes.splice(this.boxes.indexOf(t),1)},findZIndex:function(){var e=100,t=document.getElementsByTagName("*");if(!t.length)return e;for(var n=0;n<t.length;++n){var i=parseInt(t[n].style.zIndex);i>e&&(e=i)}return e+1}};return this.getManager=function(){return t},this.undefined="undefined",this.CLASSES={CONTAINER:"cBox-container",TITLE_BAR:"cBox-titleBar",BODY:"cBox-body",TITLE:"cBox-title",BUTTON:"cBox-button",CLOSE:"cBox-close",RESIZE:"cBox-resize",ACTION_BAR:"cBox-actionBar"},e&&this.create(e),this}ContentBox.prototype.create=function(e){var t=this,n=this.getManager().boxes;e=e||{},e.isMovable=typeof e.isMovable!==this.undefined?e.isMovable:!0,e.isScalable=typeof e.isScalable!==this.undefined?e.isScalable:!0,e.buttons=e.buttons||{},e.height=e.height||480,e.width=e.width||680,e.title=e.title||"Content Box",e.body=e.body||"",this.callbacks={},this.callbacks.beforeCreate=e.beforeCreate,this.callbacks.afterCreate=e.afterCreate,this.callbacks.beforeClose=e.beforeClose,"function"==typeof this.callbacks.beforeCreate&&this.callbacks.beforeCreate(n);var i={};i.id=this.getManager().nextId(),i.height=e.height,i.width=e.width,i.element=createElement("div",{id:"cBox-"+i.id,"class":this.CLASSES.CONTAINER,style:["z-index:"+this.getManager().findZIndex(),"height:"+e.height+"px","width:"+e.width+"px","top:"+(window.innerHeight/2-e.height/2)+"px","left:"+(window.innerWidth/2-e.width/2)+"px"]}),i.element.addEventListener("mousedown",function(e){var n=t.getCurrent();if(n){var a=n.element.style.zIndex;n.element.style.zIndex=i.element.style.zIndex,i.element.style.zIndex=a}t.getManager().setCurrent(i.id)},!0);var a=i.element,s=createElement("div",{id:this.CLASSES.TITLE_BAR+"-"+i.id,"class":this.CLASSES.TITLE_BAR});s.innerHTML='<span class="'+this.CLASSES.TITLE+'">'+e.title+"</span>";var o={},r={},d={};e.isMovable&&(o=function(e){return s.dataset.zIndex=a.style.zIndex,s.dataset.diffTop=a.offsetTop-e.clientY,s.dataset.diffLeft=a.offsetLeft-e.clientX,s.dataset.active="true",a.style.zIndex=t.getManager().findZIndex(),e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1,!1},r=function(e){if("true"!==s.dataset.active)return 0;var t=(a.offsetTop,a.offsetLeft,a.offsetTop+a.offsetHeight,a.offsetLeft+a.offsetWidth,e.clientY+Number(s.dataset.diffTop)),n=e.clientX+Number(s.dataset.diffLeft);0>t&&(t=0),t+a.offsetHeight>window.innerHeight&&(t=window.innerHeight-a.offsetHeight),0>n&&(n=0),n+a.offsetWidth>window.innerWidth&&(n=window.innerWidth-a.offsetWidth),a.style.top=t+"px",a.style.left=n+"px"},d=function(e){a.style.zIndex=Number(s.dataset.zIndex),clearDataset(s)}),s.addEventListener("mousedown",o),window.addEventListener("mousemove",r),window.addEventListener("mouseup",d),i.element.appendChild(s);var l=createElement("div",{id:this.CLASSES.BODY+"-"+i.id,"class":this.CLASSES.BODY});"function"==typeof e.body?e.body(l):l.innerHTML=e.body,i.element.appendChild(l);var c=createElement("a",{"class":this.CLASSES.BUTTON+" "+this.CLASSES.CLOSE,href:"javascript:void(0);"});c.addEventListener("click",function(e){t.close()},!1),c.innerHTML="Close";var h=createElement("div",{id:this.CLASSES.ACTION_BAR+"-"+i.id,"class":this.CLASSES.ACTION_BAR}),f=document.createElement("ul"),u=document.createElement("li");u.appendChild(c),f.appendChild(u);for(button in e.buttons){var p=e.buttons[button];p.href=p.href||"javascript:void(0);";var u=document.createElement("li"),x="";p["class"]!=this.undefined&&(p["class"].constructor===Array&&(p["class"]=p["class"].join(" ")),x=" "+p["class"]);var b=createElement("a",{"class":this.CLASSES.BUTTON+x,href:p.href});b.innerHTML=p.text,u.appendChild(b),f.appendChild(u)}if(h.appendChild(f),i.element.appendChild(h),e.isScalable){var C=createElement("div",{id:this.CLASSES.RESIZE+"-"+i.id,"class":this.CLASSES.RESIZE});C.addEventListener("mousedown",function(e){return C.dataset.oHeight=a.offsetHeight,C.dataset.oWidth=a.offsetWidth,C.dataset.initY=e.clientY,C.dataset.initX=e.clientX,C.dataset.active="true",e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1,!1}),window.addEventListener("mousemove",function(e){if("true"!==C.dataset.active)return 0;var t=(a.offsetHeight,a.offsetWidth,e.clientY-C.dataset.initY+Number(C.dataset.oHeight)),n=e.clientX-C.dataset.initX+Number(C.dataset.oWidth);100>t&&(t=100),200>n&&(n=200),a.style.height=t+"px",a.style.width=n+"px"}),window.addEventListener("mouseup",function(e){clearDataset(C)}),i.element.appendChild(C)}this.getManager().addBox(i),"function"==typeof this.callbacks.afterCreate&&this.callbacks.afterCreate(i)},ContentBox.prototype.getCurrent=function(){return this.getManager().getBoxById(this.getManager().current)},ContentBox.prototype.close=function(){var e=this.getCurrent();"function"==typeof this.callbacks.beforeClose&&this.callbacks.beforeClose(e),e&&this.getManager().removeBox(e.id)};
"use strict";var pbjs=pbjs||{};!function(t,r,e,o){return t.core={},t.core.prototype.extend=function(t,r){var e,n=t,c=r.split(".");for("pbjs"==c[0]&&(c=c.slice(1)),e=0;e<c.length;++e)n[c[e]]!==o&&(n[c[e]]={}),n=n[c[e]];return n},t.core.prototype.createElement=function(t,r){if(t.constructor!==String)return!1;var n,c=e.createElement(t);if(r!==o)for(n in r)r[n].constructor===Array&&(r[n]=r[n].join(";")),c.setAttribute(n,r[n]);return c},t.core.prototype.clearDataset=function(t){if((t.constructor&&t.dataset.constructor)!==Object)return!1;var r;for(r in t.dataset)delete t.dataset[r]},t}(pbjs,window,document,void 0);
"use strict";function searchTree(){var e,t;$root.find("a").closest("li").each(function(){searchArray.push($(this).clone())}),t=searchArray.length,$($settings.search.selector).keyup(function(s){if(16===s.which)return!1;var o;o="."==String.fromCharCode(s.which)?this.value+"\\"+String.fromCharCode(s.which):this.value+String.fromCharCode(s.which);var n=new RegExp(o.slice(0,-1),"ig"),i=[];e=0,$.each(searchArray,function(){var t=$(this).attr("id"),s=$(this).find("a");(t!==undefined&&t.match(n)||s.length>0&&s.text().match(n))&&(i.push($(this)),++e)}),$settings.search.callback&&"function"==typeof $settings.search.callback&&$settings.search.callback(i,e,t)})}function _showAll(){$root.find("li.pbTree-subRoot").removeClass("pbTree-closed").addClass("pbTree-opened"),$root.find("ul").show()}function _hideAll(){$root.find("li.pbTree-subRoot").removeClass("pbTree-opened").addClass("pbTree-closed"),$root.find("ul").hide()}function _brandAll(){$root.find("li").each(function(){$(this).children().is("a")||($(this).addClass("pbTree-subRoot"),$settings._showAll?$(this).addClass("pbTree-opened"):($(this).children("ul").hide(),$(this).addClass("pbTree-closed")))}),$settings.showoccupied.enable&&$root.find("li:has(a)").each(function(){$(this).css($settings.showoccupied.style)})}function _ecButtons(){$root.css({paddingBottom:$ecLinks.outerHeight()});$ecLinks.find(".pbTree-expandAll").click(function(){return _showAll(),$settings.select.enable&&$("a.pbTree-current").length>0&&$selDiv.show().css(_setSelTop()),!1}).appendTo($ecLinks),$ecLinks.find(".pbTree-collapseAll").click(function(){return _hideAll(),$container.animate({scrollTop:0},10),$ecLinks.css("bottom",0),$settings.select.enable&&$selDiv.hide(),!1}).appendTo($ecLinks)}function _setState(e){e.each(function(){$(this).toggleClass("pbTree-opened").toggleClass("pbTree-closed"),$(this).hasClass("pbTree-opened")?$(this).find("ul:first").show():$(this).find("ul:first").hide()})}function _setSelTop(){return $("a.pbTree-current").length>0&&$root.is(":visible")?{top:parseInt($("a.pbTree-current").position().top+$root.position().top+$container.scrollTop()),width:$container[0].scrollWidth}:{top:parseInt($("a.pbTree-current").position().top+$container.scrollTop()),width:$container[0].scrollWidth,display:"none"}}function _defaults(e){return $.extend(!0,{ecButtons:{enable:!0},hover:{enable:!0},search:{enable:!1,selector:undefined,callback:undefined},select:{enable:!0},showall:!1,showoccupied:{enable:!0,style:{fontWeight:"bold",color:"#000000"}},tooltip:{enable:!0,offsetX:10,offsetY:10}},e)}var $settings={},searchArray=[],$container,$root,$tooltip,$hoverDiv,$selDiv,$ecLinks,$searchBox,undefined,TreeView=function(e){if($container=$(this),$root=$container.find("ul:first"),$settings=_defaults(e),$settings.ecButtons.enable&&($ecLinks=$('<div id="pbTree-ecLinks"><a class="pbTree-expandAll" href="#">Expand All</a><a class="pbTree-collapseAll" href="#">Collapse All</a></div>').appendTo($container),_ecButtons()),$settings.tooltip.enable&&($tooltip=$('<div id="pbTree-tooltip"></div>').appendTo("body").hide()),$settings.hover.enable&&($hoverDiv=$('<div id="pbTree-hover"></div>').appendTo($container)),$settings.select.enable&&($selDiv=$('<div id="pbTree-selected"></div>').appendTo($container)),$settings.search.enable){if(!($settings.search.selector&&"string"==typeof $settings.search.selector&&$($settings.search.selector).length>0&&$($settings.search.selector).is("input:text")))return $settings.search.selector||console.error("No search selector provided!"),"string"!=typeof $settings.search.selector&&console.error("Search selector must be a string!"),$($settings.search.selector).length<=0&&console.error("The search element does not exist!"),$($settings.search.selector).is("input:text")||console.error("The search element must be a text field!"),1;searchTree()}else $searchBox=undefined;return $root.attr("id","pbTree-root").hide(),_brandAll(),$root.find("a").each(function(){$(this).click(function(){$("a.pbTree-current").length>0&&$("a.pbTree-current").removeClass("pbTree-current").removeAttr("style"),$settings.showoccupied.enable&&$(this).css($settings.showoccupied.style),$(this).addClass("pbTree-current"),$settings.select.enable&&$selDiv.show().css(_setSelTop())})}),$root.click(function(e){if($root.has(e.target).length>0&&$(e.target).hasClass("pbTree-subRoot")||e.target){var t=$(e.target);t.hasClass("pbTree-opened")?(_setState(t),$settings.select.enable&&t.find("a.pbTree-current").length>0&&$selDiv.hide()):(_setState(t),$settings.select.enable&&t.find("a.pbTree-current").length>0&&t.find("li.pbTree-closed").length<=0&&$selDiv.css(_setSelTop()).show())}}).mousemove(function(e){if($settings.hover.enable&&$root.has(e.target).length>0&&($(e.target).is("li")||$(e.target).is("a"))&&($hoverDiv.show().css({top:$(e.target).position().top+$root.position().top+$container.scrollTop(),width:$container[0].scrollWidth}),$settings.tooltip.enable)){var t=$(e.target).text().split("\n")[0];$tooltip.text(t).css({top:e.clientY+$(window).scrollTop()-$settings.tooltip.offsetY-$tooltip.outerHeight()+"px",left:e.clientX-$settings.tooltip.offsetX+"px"}).show()}}).mouseleave(function(){$settings.hover.enable&&$settings.tooltip.enable&&($hoverDiv.hide(),$tooltip.hide())}),$container.scroll(function(){$settings.select.enable&&$("a.pbTree-current").length>0&&$("a.pbTree-current").parents("li.pbTree-closed").length<=0&&$selDiv.css(_setSelTop()).show(),$settings.ecButtons.enable&&$ecLinks.css({bottom:-$container.scrollTop(),left:$container.scrollLeft()})}),$root.show(),this};$.fn.pbTree.findOne=function(e,t){var s=$("#"+e);return s.length>0?(t&&"boolean"==typeof t||(t=!0),t&&_hideAll(),$("a.pbTree-current").length>0&&$("a.pbTree-current").removeClass("pbTree-current"),s.parentsUntil("ul.pbTree-root").show().addClass("pbTree-opened"),s.children("a").addClass("pbTree-current").trigger("click"),$settings.select.enable&&$selDiv.hide().css(_setSelTop()).show(),this):!1};